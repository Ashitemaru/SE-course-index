# 网络请求

## 实验目的

通过本 Step，我们希望你能够掌握如何发送和处理网络请求，从而完成整个小作业的前端。

## 实验步骤

首先，你需要在理解 JavaScript 的异步与 then 链语法的基础上，简单理解 Axios 库的使用方式，了解如何创建一个网络请求并按照 API 文档要求携带参数。

之后，你需要在文件 `src/pages/list/index.tsx` 中的 `ListScreen` 组件内完成两处代码填空，完成网络请求的发送和处理。

第一处，函数 `deleteBoard` 用于删除指定的游戏记录。本处填空的代码量在 20 行以内。该函数应当绑定在每一条游戏列表的 Delete it 按钮上，用于处理用户的点击行为。

第二处，函数 `deleteUserBoard` 用于删除指定用户的所有游戏记录。本处填空的代码量在 20 行以内。

完成本 Step 后，你的游戏记录列表的交互应当和下述 GIF 图所展示的类似：

![](../../static/react/step6-demo.gif)

### 代码说明

我们已经在 `src/utils/network.ts` 中展现了一个基于 Axios 的网络请求 wrapper 的写法，包括简单的错误处理。另外，本小作业框架中我们已经使用这个 wrapper 写过多个网络请求处理函数，你可以参考这些代码来完成本 Step。

## 实验评分

本 Step 总分为 25 分。

本 Step 采用人工评分。我们仅会**在通过 CI 检查的基础上**查看最后一次部署是否满足：

- （8 分）前后端通信正常
- （8 分）点击某一条记录的 Delete it 按钮能够删除该记录，弹窗提示删除成功，关闭弹窗后该记录已经消失
- （8 分）点击 Delete all boards of this user 按钮能够删除该用户的所有记录，弹窗提示删除成功
- （1 分）删除某用户的所有记录后，退回到 `/list` 页面

我们会从第二项开始按顺序检查到最后一项，若均通过，则自动获得第一项的全部分数。否则，只要有一项不通过，则第一项计 0 分。

由于本 Step 涉及到网络请求，如果出现网络错误提示弹窗或者 5 秒内页面没有反应，我们会重试一次。若重试依然不成功则判定该功能点不得分。

## 知识讲解

由于本 Step 所涉及的技术要点基本都有成熟的文档介绍，这里直接引用参考文档链接。

最基本的 JS/TS 语言异步语法（包含 then 链语法）可以参考 [技能引导文档相关页面](https://docs.net9.org/languages/javascript/async/)。

函数组件中的网络请求往往需要使用 `useEffect` Hook 管理。`useEffect` Hook 的使用方法可以参考 [技能引导文档相关页面](https://docs.net9.org/frontend/react/function-component/#_3)。

本小作业框架使用 Axios 完成网络请求。Axios 的一个最小化使用示例见 [Axios 官方文档相关页面](https://axios-http.com/docs/example)，该示例足以支撑完成本 Step。Axios 更深入的知识可以自行学习。

!!! success "🎉"

    这是你前端小作业的最后一个 Step 了，如果你已经完成了，我相信你已经充分掌握了 Next.js 的入门知识。

    事实上这份前端小作业几乎可以作为大作业的起始框架。除了 Next.js 框架本身，其包含了：

    - 代码风格检查与修正插件 ESLint，配置文件为 `.eslintrc.json`
    - 单元测试框架 Jest

    一些拓展知识则可以看后续的 Appendix 部分学习。
    
    希望你能够在大作业中运用好小作业中学到的知识，祝你好运。